{% trans_default_domain 'FOSUserBundle' %}

{% set user = app.user %}
<div class="row">
    <div class="col-md-3">
        <ul id="shorcuts" class="nav nav-pills nav-stacked">
            <li role="presentation" class="active"><a href="#socials" aria-controls="socials">Réseaux sociaux</a></li>
            <li role="presentation"><a href="#profil" aria-controls="profil">Profil</a></li>
            <li role="presentation"><a href="#password" aria-controls="password">Mot de passe</a></li>
            <li role="presentation"><a href="#supprimer" aria-controls="supprimer">Supprimer le compte</a></li>
        </ul>
    </div>
    <div class="col-md-7">
        <div id="socials" class="panel panel-default">
            <div class="panel-heading bg-white">
                <h2 class="modal-title">Réseaux sociaux</h2>
            </div>
            <div class="panel-body">
                {% for service in ['facebook', 'google', 'twitter'] %}
                    <div class="bloc_config">
                        {% include "Social/social.html.twig" with { 'info': app.user.info, 'service': service } %}
                    </div>
                {% endfor %}
                <br />
            </div>
        </div>
        <div id="profil" class="panel panel-default">
            <div class="panel-heading bg-white">
                <h2 class="modal-title">Profil</h2>
            </div>
            <div class="panel-body">
                {% form_theme form 'Form/fields_horizontal.html.twig' %}
                {{ form_start(form, { 'action': path('fos_user_profile_edit'), 'attr': { 'enctype': 'multipart/form-data'} }) }}
                <div class="form-group">
                    {{ form_label(form.imageFile, null, {'label_attr': {'class': 'col-md-4 control-label'}}) }}
                    <div class="col-md-8">
                        {% if not user.path %}
                            {% set imageURL = userProfilePicture.getProfilePicture(user) %}
                            <img class="img img-responsive" src="{{ imageURL }}" style="max-height: 200px;" />
                        {% endif %}
                        {{ form_errors(form.imageFile) }}
                        {{ form_widget(form.imageFile) }}
                    </div>
                </div>

                {{ form_row(form.username) }}
                {{ form_row(form.email) }}
                {{ form_row(form.firstname) }}
                {{ form_row(form.lastname) }}
                {{ form_row(form.description) }}
                {{ form_row(form.website) }}
                {{ form_row(form.showSocials) }}
                <br />
                <div class="form-group">
                    <div class="col-md-offset-4 col-md-8">
                        <input type="submit" class="btn btn-primary btn-raised btn-block"
                               value="Modifier mes informations" />
                    </div>
                </div>
                {{ form_rest(form) }}
                {{ form_end(form) }}
            </div>
        </div>
        <div id="password" class="panel panel-default">
            <div class="panel-heading bg-white">
                <h2 class="modal-title">Mot de passe</h2>
            </div>
            <div class="panel-body">
                {% form_theme formChangePassword 'Form/fields_horizontal.html.twig' %}
                {{ form_start(formChangePassword, { 'action': path('fos_user_change_password') }) }}
                {{ form_row(formChangePassword.current_password) }}
                {{ form_row(formChangePassword.plainPassword.first) }}
                {{ form_row(formChangePassword.plainPassword.second) }}
                <div class="form-group">
                    <div class="col-md-offset-4 col-md-8">
                        <input type="submit" class="btn btn-primary btn-raised btn-block"
                               value="{{ 'change_password.submit'|trans }}" />
                    </div>
                </div>
                {{ form_rest(formChangePassword) }}
                {{ form_end(formChangePassword) }}
            </div>
        </div>
        <div id="supprimer" class="panel panel-default">
            <div class="panel-heading bg-white">
                <h2 class="modal-title">Supprimer le compte</h2>
            </div>
            <div class="panel-body">
                <p>Supprimer les informations relatives à mon compte</p>
                <div class="form-group">
                    <div class="col-md-offset-4 col-md-8">
                        <button id="btnDelete" type="button" data-toggle="modal" data-target="#deleteModal" class="btn btn-danger btn-raised btn-block">
                            Supprimer mon compte
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% include "@FOSUser/Profile/_modal_delete.html.twig" %}
